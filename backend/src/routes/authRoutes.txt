// backend/src/routes/authRoutes.js

const express = require("express");
const router = express.Router();
const auth = require("../controllers/authControllers");
const { protect } = require("../middlewares/authMiddleware");
const { rateLimitByIP, checkBlockedIP } = require('../middlewares/securityMiddleware');

// Regular Auth
router.post("/register", auth.register);
// router.post("/login", auth.login);
router.post('/login', checkBlockedIP, rateLimitByIP({ maxAttempts: 5, windowMs: 15 * 60 * 1000 }), auth.login);
router.post("/logout", protect, auth.logout);

// OAuth Routes
router.post('/google-login', auth.googleLogin);
router.post('/microsoft-login', auth.microsoftLogin);

// OTP Routes
router.post("/verify-otp", auth.verifyOtp);
router.post("/resend-otp", auth.resendOtp);

// Password Reset
router.post("/forgot-password", auth.forgotPassword);
router.post("/reset-password", auth.resetPassword);


module.exports = router;